# Redis HA Quick Start Guide

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose down

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é —Å Sentinel
docker-compose up -d
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose ps

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Sentinel
docker exec -it zephyrvpn_redis_sentinel_1 redis-cli -p 26379 SENTINEL masters
```

### 3. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í `docker-compose.yml` —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:
```yaml
REDIS_SENTINEL_ADDRS: redis-sentinel-1:26379,redis-sentinel-2:26379,redis-sentinel-3:26379
REDIS_MASTER_NAME: mymaster
```

### 4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ failover

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∞—Å—Ç–µ—Ä
docker stop zephyrvpn_redis_master

# –ü–æ–¥–æ–∂–¥–∞—Ç—å 5-10 —Å–µ–∫—É–Ω–¥

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞
docker exec -it zephyrvpn_redis_sentinel_1 redis-cli -p 26379 SENTINEL get-master-addr-by-name mymaster
```

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **docker-compose.yml** - –æ–±–Ω–æ–≤–ª–µ–Ω —Å Master/Replica/Sentinel (–∑–∞–º–µ–Ω–µ–Ω —Å—Ç–∞—Ä—ã–π Redis)
2. **redis-sentinel.conf** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Sentinel
3. **docs/REDIS_SENTINEL_SETUP.md** - –ø–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π –∫–æ–¥

- `internal/database/redis.go` - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ Sentinel
- `internal/config/config.go` - —á—Ç–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `main.go` - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

## üîÑ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

- –°—Ç–∞—Ä—ã–π —Å–µ—Ä–≤–∏—Å `redis` –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ `redis-master` + 2 —Ä–µ–ø–ª–∏–∫–∏ + 3 Sentinel
- –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ—Ç—å `redis-network` –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω—ã –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Å–µ—Ä–≤–∏—Å–µ `api` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Sentinel
- –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ volumes –¥–ª—è –¥–∞–Ω–Ω—ã—Ö Redis –∏ Sentinel

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–¥–Ω–æ–π —Å–µ—Ç–∏ `redis-network`
- Sentinel —Ç—Ä–µ–±—É–µ—Ç –º–∏–Ω–∏–º—É–º 2 –≥–æ–ª–æ—Å–∞ –¥–ª—è failover (quorum=2)
- Master –±–µ–∑ –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- Replicas —Å –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

