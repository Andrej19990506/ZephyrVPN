# –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:

‚úÖ **Recipe –Ω–∞–π–¥–µ–Ω:** "–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è" (ID: `6348a121-3cd4-4dca-b905-7d39a04f899f`)
‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞:** Recipe –Ω–µ —Å–≤—è–∑–∞–Ω —Å NomenclatureItem (menu_item_id = NULL)
‚úÖ **–û—Å—Ç–∞—Ç–∫–∏ –µ—Å—Ç—å:** 3 –ø–∞—Ä—Ç–∏–∏, –≤—Å–µ–≥–æ 515000 –µ–¥–∏–Ω–∏—Ü
‚úÖ **–§–∏–ª–∏–∞–ª:** "–í–∏–ª—å—Å–∫–æ–≥–æ" (ID: `3144f6ec-9f6c-4e1a-8f1a-e7205ba48c21`)

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (OrderEntry)

1. –û—Ç–∫—Ä–æ–π —Ñ–æ—Ä–º—É —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
2. –î–æ–±–∞–≤—å "–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è" –≤ –∫–æ—Ä–∑–∏–Ω—É
3. **–í–ê–ñ–ù–û:** –£–±–µ–¥–∏—Å—å, —á—Ç–æ –≤ –∑–∞–ø—Ä–æ—Å–µ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è `branch_id`:
   ```javascript
   {
     branch_id: "3144f6ec-9f6c-4e1a-8f1a-e7205ba48c21", // ID —Ñ–∏–ª–∏–∞–ª–∞ "–í–∏–ª—å—Å–∫–æ–≥–æ"
     is_pickup: true,
     items: [{
       pizza_name: "–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è",
       quantity: 1,
       extras: []
     }]
   }
   ```
4. –ù–∞–∂–º–∏ "–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑"
5. **–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
   - –ï—Å–ª–∏ –æ—Å—Ç–∞—Ç–∫–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚Üí –∑–∞–∫–∞–∑ —Å–æ–∑–¥–∞–µ—Ç—Å—è (200 OK)
   - –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ ‚Üí –æ—à–∏–±–∫–∞ 400 —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ Postman/curl

```bash
POST http://localhost:8080/api/v1/orders
Content-Type: application/json

{
  "branch_id": "3144f6ec-9f6c-4e1a-8f1a-e7205ba48c21",
  "is_pickup": true,
  "items": [
    {
      "pizza_name": "–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è",
      "quantity": 1,
      "extras": []
    }
  ]
}
```

---

## üîç –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞:

–ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–∞ –ø—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏ Go —Å–µ—Ä–≤–µ—Ä–∞:

### ‚úÖ –£—Å–ø–µ—à–Ω—ã–π —Å–ª—É—á–∞–π (–æ—Å—Ç–∞—Ç–∫–æ–≤ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ):
```
‚ö†Ô∏è –†–µ—Ü–µ–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è –ø–∏—Ü—Ü—ã '–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è': ...
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–∞
‚úÖ –ó–∞–∫–∞–∑ —Å–æ–∑–¥–∞–Ω: ID=...
```

### ‚ùå –û—à–∏–±–∫–∞ (–æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ):
```
‚ö†Ô∏è –†–µ—Ü–µ–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è –ø–∏—Ü—Ü—ã '–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è': ...
‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—Å—Ç–∞—Ç–∫–æ–≤ –¥–ª—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–∞ '...': —Ç—Ä–µ–±—É–µ—Ç—Å—è X –≥, –¥–æ—Å—Ç—É–ø–Ω–æ Y –≥
```

---

## ‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

### 1. Recipe –Ω–µ —Å–≤—è–∑–∞–Ω —Å NomenclatureItem

**–ü—Ä–æ–±–ª–µ–º–∞:** Recipe "–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è" –∏–º–µ–µ—Ç `menu_item_id = NULL`

**–†–µ—à–µ–Ω–∏–µ:** –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç fallback - –ø—Ä—è–º–æ–π –ø–æ–∏—Å–∫ Recipe –ø–æ –∏–º–µ–Ω–∏. –≠—Ç–æ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ –ª—É—á—à–µ —Å–≤—è–∑–∞—Ç—å —á–µ—Ä–µ–∑ Technologist Workspace:
- –û—Ç–∫—Ä–æ–π Technologist Workspace
- –ù–∞–π–¥–∏ "–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è" 
- –£–±–µ–¥–∏—Å—å, —á—Ç–æ –æ–Ω–∞ —Å–≤—è–∑–∞–Ω–∞ —Å NomenclatureItem (IsSaleable=true)

### 2. –ù–µ—Ç –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤ –≤ —Ä–µ—Ü–µ–ø—Ç–µ

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
SELECT COUNT(*) FROM recipe_ingredients 
WHERE recipe_id = '6348a121-3cd4-4dca-b905-7d39a04f899f';
```

–ï—Å–ª–∏ 0 ‚Üí –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã —á–µ—Ä–µ–∑ Technologist Workspace

### 3. –ù–µ—Ç –æ—Å—Ç–∞—Ç–∫–æ–≤ –¥–ª—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```sql
-- –ù–∞–π–¥–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã —Ä–µ—Ü–µ–ø—Ç–∞
SELECT ri.nomenclature_id, n.name, ri.quantity, ri.unit
FROM recipe_ingredients ri
JOIN nomenclature_items n ON ri.nomenclature_id = n.id
WHERE ri.recipe_id = '6348a121-3cd4-4dca-b905-7d39a04f899f';

-- –ü—Ä–æ–≤–µ—Ä—å –æ—Å—Ç–∞—Ç–∫–∏ –¥–ª—è —ç—Ç–∏—Ö –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
SELECT n.name, SUM(sb.remaining_quantity) as total
FROM stock_batches sb
JOIN nomenclature_items n ON sb.nomenclature_id = n.id
WHERE sb.branch_id = '3144f6ec-9f6c-4e1a-8f1a-e7205ba48c21'
  AND sb.is_expired = false
GROUP BY n.name;
```

---

## üéØ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ SQL:

```sql
-- 1. –ü—Ä–æ–≤–µ—Ä—å, –µ—Å—Ç—å –ª–∏ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã –≤ —Ä–µ—Ü–µ–ø—Ç–µ
SELECT COUNT(*) as ingredient_count 
FROM recipe_ingredients 
WHERE recipe_id = '6348a121-3cd4-4dca-b905-7d39a04f899f';

-- 2. –ü—Ä–æ–≤–µ—Ä—å –æ—Å—Ç–∞—Ç–∫–∏ –¥–ª—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
SELECT 
  n.name,
  ri.quantity as required,
  ri.unit as required_unit,
  COALESCE(SUM(sb.remaining_quantity), 0) as available
FROM recipe_ingredients ri
JOIN nomenclature_items n ON ri.nomenclature_id = n.id
LEFT JOIN stock_batches sb ON sb.nomenclature_id = n.id 
  AND sb.branch_id = '3144f6ec-9f6c-4e1a-8f1a-e7205ba48c21'
  AND sb.is_expired = false
WHERE ri.recipe_id = '6348a121-3cd4-4dca-b905-7d39a04f899f'
GROUP BY n.name, ri.quantity, ri.unit;
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ —Ç–µ—Å—Ç–æ–º:

- [ ] –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (`go run main.go`)
- [ ] –§—Ä–æ–Ω—Ç–µ–Ω–¥ –∑–∞–ø—É—â–µ–Ω
- [ ] –í OrderEntry –µ—Å—Ç—å –ø–æ–ª–µ –¥–ª—è `branch_id` (–∏–ª–∏ –æ–Ω–æ –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- [ ] Recipe "–ü–∏—Ü—Ü–∞ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è" —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- [ ] –£ Recipe –µ—Å—Ç—å –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã
- [ ] –ù–∞ —Å–∫–ª–∞–¥–µ –µ—Å—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –¥–ª—è –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç–æ–≤
- [ ] –§–∏–ª–∏–∞–ª "–í–∏–ª—å—Å–∫–æ–≥–æ" —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

---

## üêõ –û—Ç–ª–∞–¥–∫–∞:

–ï—Å–ª–∏ –∑–∞–∫–∞–∑ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å:

1. **–í –ª–æ–≥–∞—Ö Go —Å–µ—Ä–≤–µ—Ä–∞:**
   - –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∞ "–†–µ—Ü–µ–ø—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω"?
   - –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∞ "–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –æ—Å—Ç–∞—Ç–∫–æ–≤"?
   - –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∞ "branch_id –Ω–µ —É–∫–∞–∑–∞–Ω"?

2. **–í Network tab –±—Ä–∞—É–∑–µ—Ä–∞:**
   - –ö–∞–∫–æ–π HTTP —Å—Ç–∞—Ç—É—Å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è?
   - –ö–∞–∫–æ–µ —Ç–µ–ª–æ –æ—Ç–≤–µ—Ç–∞ (error message)?

3. **–í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:**
   - –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ JavaScript?
   - –ü–µ—Ä–µ–¥–∞–µ—Ç—Å—è –ª–∏ `branch_id` –≤ –∑–∞–ø—Ä–æ—Å–µ?

